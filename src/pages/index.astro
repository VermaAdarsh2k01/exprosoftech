---
import Base from "@/layouts/Base.astro";
import { Clients } from "../components/Clients";
import { Offerings } from "../components/Offerings";
import CaseStudies from "../components/CaseStudies";
import NewFAQ from "../components/NewFAQ";
import { FeaturesGrid } from "../components/FeaturesGrid";
import { ScrollableServices } from "../components/ScrollableServices";
import { ProductSection } from "../components/ProductSection";
import { HomeBanner } from "../components/HomeBanner";
import { sanityClient } from "sanity:client";

const pageData = await sanityClient.fetch(`
  *[_type == "homepage"][0] {
    heroBanner {
      title,
      description,
      
      image[] { src, alt },
      buttons[] { label, link, isCalendly }
    },
    clientsSection { clients[] { name, "logo": logo.asset->url } },
    offeringsSection {
      heading { title, subtitle, description },
      offerings[] { title, description, "icon": icon.asset->url }
    },
    FeaturesSection {
      heading { title, subtitle, description },
      features[] {
        tagline,
        title,
        description,
        "image": image.asset->url,
        icon
      }
    },
    ScrollableServicesSection {
      heading { title, subtitle, description },
      services[] {
        number,
        title,
        subheading,
        description,
        "image": image.asset->url
      }
    },
    productsSection {
      products[] {
        title,
        description,
        "image": image.asset->url,
        label,
        buttonHref,
        buttonLabel,
        mainCTA,
        features[] { title, description }
      }
    },
    faqSection {
      title,
      subtitle,
      description,
      list[] { title, description, active }
    }
  }
`);
---

<Base>
  <HomeBanner client:load data={pageData.heroBanner} />
  <Clients client:load />
  <Offerings client:load data={pageData.offeringsSection} />
  <FeaturesGrid client:load data={pageData.FeaturesSection} />
  <ScrollableServices client:load data={pageData.ScrollableServicesSection} />
  <ProductSection client:load data={pageData.productsSection} />
  <!-- <CaseStudies client:load /> -->
  <NewFAQ client:load Faq={[pageData.faqSection]} />
</Base>
