---
import DemandDrivenBanner from "../../components/DemandDrivenBanner";
import DemandDrivenImpact from "../../components/DemandDrivenImpact";
import ChallengesWeAddress from "../../components/ChallengesWeAddress";
import BusinessImpact from "../../components/BusinessImpact";
import KeyServices from "../../components/KeyServices";
import BusinessGuidance from "../../components/BusinessGuidance";
import CaseStudies from "../../components/CaseStudies";
import ConsultationCTA from "../../components/ConsultationCTA";
import FAQ from "../../components/FAQ";
import Base from "@/layouts/Base.astro";
import { getEntry } from "astro:content";
import { Clients } from "../../components/Clients";
const consulting = await getEntry("consulting", "-index");
const bannerData = await getEntry("sections", "demand-driven-banner");
const { title, description, meta_title, image } = consulting?.data || {};

import { sanityClient } from "sanity:client"

const HEADING_QUERY = `*[_type == "heading"]{
  _id,
  subtitle,
  title,
  description
}`;

const FAQ_QUERY = `*[_type == "faq"] | order(_createdAt desc) {
  title,
  description
}`

const DEMAND_DRIVEN_FAQ_QUERY = `*[_type == "demandDrivenFaq"]{
  title,
  description
}`;

const headings = await sanityClient.fetch(HEADING_QUERY);
const faqData = await sanityClient.fetch(FAQ_QUERY)
const demandDrivenFaqs = await sanityClient.fetch(DEMAND_DRIVEN_FAQ_QUERY);
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}
>
  <DemandDrivenBanner client:load />
  <Clients client:load/>
  <DemandDrivenImpact client:load />
  <ChallengesWeAddress client:load />
  <!-- <BusinessImpact client:load /> -->
  <KeyServices client:load />
  <BusinessGuidance client:load />
  <!-- <CaseStudies client:load /> -->
  <ConsultationCTA client:load />
  <FAQ heading={headings[0]} faqData={faqData} demandDrivenFaqData={demandDrivenFaqs} client:load variant="demand-driven" />
</Base>
